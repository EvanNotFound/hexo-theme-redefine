<div class="post-page-container">
    <div class="article-content-container">

        <div class="article-title">
            <% if (page.cover || page.banner || (page.thumbnail && page.thumbnail !== false)) { %>
                <% let articleCover = "";
                if (page.cover && page.cover.includes("/")) {
                articleCover = page.cover;
                } else if (page.banner && page.banner.includes("/")) {
                articleCover = page.banner;
                } else if (page.thumbnail && page.thumbnail !== null) {
                articleCover = page.thumbnail;
                } else if (config.marked.postAsset && config.marked.postAsset == true) {
                articleCover = [page.path, page.cover || page.banner].join("/");
                }
                %>
                <% if (articleCover) { %>
                <img src="<%= url_for(articleCover) %>" alt="<%= page.title %>" class="max-w-none"/>
                <% } %>
                <h1 class="article-title-cover"><%= page.title %></h1>
            <% } else { %>
                <h1 class="article-title-regular"><%= page.title %></h1>
            <% } %>
            </div>
            
                    
        
        
        <% if (theme.info.author || config.author || page.author.name) { %>
            <div class="article-header">
                <div class="avatar">
                    <% if (page.author.avatar) { %>
                        <%- image_tag(page.author.avatar) %>
                    <% } else { %>
                        <%- image_tag(theme.defaults.avatar) %>
                    <% } %>
                </div>
                <div class="info">
                    <div class="author">
                        <% if (page.author.name) { %>
                            <span class="name"><%= page.author.name %></span>
                        <% } else { %>
                            <span class="name"><%= theme.info.author || config.author %></span>
                        <% } %>
                        <% if (theme.hasOwnProperty('articles') && theme.articles.author_label.enable === true) { %>
                            <% if (page.author.label) { %>
                                <span class="author-label"><%= page.author.label %></span>
                            <% } else { %>
                                <span class="author-label"><%- getAuthorLabel(site.posts.length, theme.articles.author_label.auto, theme.articles.author_label.list) %></span>
                            <% } %>
                        <% } %>
                    </div>
                    <div class="meta-info">
                        <%- partial('_meta/article-info', {articleObject: page, index: true}) %>
                    </div>
                </div>
            </div>
        <% } else { %>
            <div class="article-header-meta-info">
                <div class="meta-info">
                    <%- partial('_meta/article-info', {articleObject: page, index: true}) %>
                </div>
            </div>
        <% } %>

        <% if (page.expires && page.expires !== "") {%>
                <div class="note red icon article-expire hidden" id="expiration-container">
                    <i class="fa-solid fa-timer expire-icon"></i>
                    <span class="expire-label" id="expiration-date"><%= __('expired', "some") %></span>
                </div>

            <script data-swup-reload-script>
                function updateExpirationDate() {
                    var expiredDate = new Date("<%= page.expires %>");
                    const updatedDate = new Date("<%= page.updated %>");
                    let now = new Date();
                    const expirationValue = document.getElementById("expiration-date");
                    const expirationContainer = document.getElementById("expiration-container");
                    let daysAgo = Math.floor((now - updatedDate) / (1000 * 60 * 60 * 24));
                    if (expiredDate < now) {
                        expirationContainer.classList.remove("hidden");
                        console.log(daysAgo)
                        expirationValue.innerHTML = expirationValue.innerHTML.replace("some", daysAgo);
                    }
                }
                document.addEventListener("DOMContentLoaded", function () {
                    updateExpirationDate();
                });
                swup.hooks.on("page:view",updateExpirationDate)
            </script>
        <% } %>


        <div class="article-content markdown-body">
            <%- page.content %>
        </div>

        <% if (theme.articles.copyright) { %>
            <div class="post-copyright-info">
                <%- partial('_meta/article-copyright') %>
            </div>
        <% } %>

        <% if (page.tags.length) { %>
            <ul class="post-tags-box">
                <% page.tags.forEach((tag) => { %>
                    <li class="tag-item">
                        <a href="<%- url_for(tag.path) %>">#<%= tag.name %></a>&nbsp;
                    </li>
                <% }); %>
            </ul>
        <% } %>

        <%- articleRecommendationGenerator(page) %>

        <% if (page.prev || page.next) { %>
            <div class="article-nav">
                <% if (page.prev) { %>
                    <div class="article-prev">
                        <a class="prev"
                        rel="prev"
                        href="<%= url_for(page.prev.path) %>"
                        >
                            <span class="left arrow-icon flex justify-center items-center">
                                <i class="fa-solid fa-chevron-left"></i>
                            </span>
                            <span class="title flex justify-center items-center">
                                <span class="post-nav-title-item"><%= page.prev.title %></span>
                                <span class="post-nav-item"><%= __('prev_posts') %></span>
                            </span>
                        </a>
                    </div>
                <% } %>
                <% if (page.next) { %>
                    <div class="article-next">
                        <a class="next"
                        rel="next"
                        href="<%= url_for(page.next.path) %>"
                        >
                            <span class="title flex justify-center items-center">
                                <span class="post-nav-title-item"><%= page.next.title %></span>
                                <span class="post-nav-item"><%= __('next_posts') %></span>
                            </span>
                            <span class="right arrow-icon flex justify-center items-center">
                                <i class="fa-solid fa-chevron-right"></i>
                            </span>
                        </a>
                    </div>
                <% } %>
            </div>
        <% } %>


        <% if (theme.comment.enable === true && theme.comment.hasOwnProperty('system') && page.comment !== false && page.comment !== false) { %>
            <div class="comment-container">
                <%- partial('_partials/comments/comment') %>
            </div>
        <% } %>
    </div>

    <% if (is_post() && theme.articles.toc.enable === true) { %>
        <div class="toc-content-container">
            <%- partial('_widgets/toc') %>
        </div>
    <% } %>
</div>

