export function initMasonryModal(){function initMasonryClickHandlers(){console.log("[MasonryModal] initMasonryClickHandlers() binding .masonry-item click handlers"),document.querySelectorAll(".masonry-item").forEach((e=>{e.hasListener||(e.hasListener=!0,e.addEventListener("click",(function(e){("IMG"===e.target.tagName||e.target.closest("img"))&&(e.preventDefault(),e.stopImmediatePropagation()),function showMasonryModal(e){const t=document.getElementById("masonry-modal");t&&t.remove();let n=e.date;try{const t=new Date(e.date);isNaN(t)||(n=t.toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}))}catch(e){}const a=document.createElement("div");a.id="masonry-modal",a.className="masonry-modal",a.style.zIndex="999999",a.innerHTML=`\n      <div class="masonry-modal-content">\n        <button class="masonry-modal-close">&times;</button>\n        <div class="masonry-modal-body">\n          <div class="masonry-modal-image">\n            <img src="${e.image}" alt="${e.title}">\n          </div>\n          <div class="masonry-modal-info">\n            <h2>${e.title}</h2>\n            <div class="masonry-modal-meta">\n              <div class="meta-item">\n                <span class="meta-label">拍摄时间:</span>\n                <span class="meta-value">${n}</span>\n              </div>\n              <div class="meta-item">\n                <span class="meta-label">拍摄地点:</span>\n                <span class="meta-value">${e.location}</span>\n              </div>\n            </div>\n            <div class="masonry-modal-description">\n              <p>${e.description}</p>\n            </div>\n          </div>\n        </div>\n      </div>\n    `,document.body.appendChild(a);const o=a.querySelector(".masonry-modal-image img");let s=1,i=!1,l=0,d=0,r=0,c=0;const m=a.querySelector(".masonry-modal-image");m.addEventListener("wheel",(e=>{e.preventDefault();const t=e.deltaY>0?.9:1.1;s=Math.max(.5,Math.min(3,s*t)),updateImageTransform()})),m.addEventListener("mousedown",(e=>{s>1&&(i=!0,l=e.clientX-r,d=e.clientY-c,m.style.cursor="grabbing",e.preventDefault())})),document.addEventListener("mousemove",(e=>{if(i){const t=m.getBoundingClientRect(),n=t.width*(s-1)/2,a=t.height*(s-1)/2;r=Math.max(-n,Math.min(n,e.clientX-l)),c=Math.max(-a,Math.min(a,e.clientY-d)),updateImageTransform()}})),document.addEventListener("mouseup",(()=>{i=!1,m.style.cursor="grab"}));let u=0;function updateImageTransform(){1===s&&(r=0,c=0),o.style.transform=`scale(${s}) translate(${r/s}px, ${c/s}px)`}m.addEventListener("touchstart",(e=>{if(2===e.touches.length){const t=e.touches[0].clientX-e.touches[1].clientX,n=e.touches[0].clientY-e.touches[1].clientY;u=Math.sqrt(t*t+n*n)}})),m.addEventListener("touchmove",(e=>{if(2===e.touches.length){e.preventDefault();const t=e.touches[0].clientX-e.touches[1].clientX,n=e.touches[0].clientY-e.touches[1].clientY,a=Math.sqrt(t*t+n*n),o=a/u;s=Math.max(.5,Math.min(3,s*o)),u=a,updateImageTransform()}})),m.addEventListener("dblclick",(()=>{s=1,r=0,c=0,updateImageTransform()})),m.style.cursor="grab",m.style.overflow="hidden",m.style.userSelect="none",a.querySelector(".masonry-modal-close").addEventListener("click",(()=>{a.remove()})),a.addEventListener("click",(e=>{e.target===a&&a.remove()})),setTimeout((()=>{a.classList.add("show")}),10)}({title:this.dataset.title,description:this.dataset.description,date:this.dataset.date,location:this.dataset.location,image:this.querySelector("img").src})}),!0))}))}console.log("[MasonryModal] initMasonryModal() called"),"loading"===document.readyState?document.addEventListener("DOMContentLoaded",initMasonryClickHandlers):initMasonryClickHandlers();try{swup.hooks.on("page:view",(()=>{console.log("[MasonryModal] swup page:view fired"),initMasonryClickHandlers()})),swup.hooks.on("content:replace",(()=>{console.log("[MasonryModal] swup content:replace fired"),initMasonryClickHandlers()}))}catch(e){}}export default function initMasonryModalPlugin(){document.querySelector("#masonry-container")&&initMasonryModal()}
//# sourceMappingURL=masonry-modal.js.map